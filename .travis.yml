language: node_js

node_js:
  - "10"
install:
  - npm install

script:
    - npm run build

after_script:
  # 找到静态资源
  - cd ./public
  - git init
  # user.name 和 user.email 让 travis 能登录你的 github
  - git config user.name "xnhao"
  - git config user.email "xnhao@ifltek.com"
  - git add .
  - git commit -m "update"
  # GH_TOKEN 为你的 github 允许 travis 访问生成的凭证
  # GH_REF 告诉 travis 往哪个仓库推送代码，具体值下面配置
  - git push --force --quiet "https://${GIT_TOKEN}@${GIT_REF}" master:master
# E: Build LifeCycle

deploy:
  stage: deploy
  provider: pages
  skip_cleanup: true
  github_token: $GIT_TOKEN  # Set in the settings page of your repository, as a secure variable
  keep_history: true
  on:
    branch: master